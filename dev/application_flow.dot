digraph g {
	/* comment */
	comment [ label="This graph shows the execution flow\nfrom application start to the main loop.\nFor completeness some of the commands\nthat can spawn a new instance are\nshown as well. For a running application\nall the work is done in the main loop." shape=note]

	/* starting points */
	main [ label="main()\nzim.py" shape = box]
	cgibin [label = "zim.cgi" shape = box]
	{ rank=same; main; cgibin }

	parseargv [ lable = "parse argv" shape = diamond ]
	dispatch [ shape = diamond ]
	usageerror [label = "Usage Error" ]

	/* main loops */
	gtkmain [label = "gtk.main()" peripheries = 2]
	wwwloop [ label = "server_forever()\nBasehHTTPServer" peripheries = 2]
	{ rank=same; gtkmain; wwwloop }

	/* other steps */
	guimain [label = "GtkInterface.main()\nzim.gui"]
	gtksignal [label ="gtk.signal_emit()" ]
	wwwmain [ label = "Server.main()\nzim.www" ]
	wwwserve [ label = "WWWInterface.serve(request)"]
	exporter [ label = "CommandInterface.export()\nzim.command"]
	wwwcgi [label = "Handler.main()\nzim.www" ]

	/* primary flow from start to main loop */
	main -> parseargv
	parseargv -> dispatch
	parseargv -> usageerror [minlen = 0]
	dispatch -> guimain [label="--gui (default)"]
	dispatch -> wwwmain [label="--server"]
	dispatch -> exporter [label="--export"]
	guimain -> gtkmain
	wwwmain -> wwwloop

	/* flow cgi-bin */
	cgibin -> wwwcgi
	wwwcgi -> wwwserve

	/* actions spawned by main loop */
	gtkmain -> gtksignal [style = dotted]
	gtksignal -> "open_notebook()" [style = dotted]
	"open_notebook()" -> main [style = dotted label ="--gui"]
	gtksignal -> "start_server()" [style = dotted]
	"start_server()" -> main [style = dotted label ="--server --gui"]
	gtksignal -> "show_help()" [style = dotted]
	"show_help()" -> main [style = dotted label ="--doc"]
	wwwloop -> wwwserve [style = dotted]
}
